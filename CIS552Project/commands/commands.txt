CREATE TABLE lineitem (orderkey INT,partkey INT,suppkey INT,linenumber INT,quantity DECIMAL,extendedprice  DECIMAL,discount DECIMAL,tax DECIMAL,returnflag CHAR(1),linestatus CHAR(1),shipdate DATE,commitdate DATE,receiptdate DATE,shipinstruct CHAR(25),shipmode CHAR(10),comment VARCHAR(44));
CREATE TABLE orders (orderkey INT, custkey        INT,orderstatus    CHAR(1),totalprice     DECIMAL,orderdate      DATE,orderpriority  CHAR(15),clerk          CHAR(15),shippriority   INT,comment        VARCHAR(79));
CREATE TABLE supplier (suppkey INT,name         CHAR(25),address      VARCHAR(40),nationkey    INT,phone        CHAR(15),acctbal      DECIMAL,comment      VARCHAR(101));
CREATE TABLE part (partkey INT,name VARCHAR(55),mfgr CHAR(25),brand CHAR(10),type VARCHAR(25),size INT,container CHAR(10),retailprice  DECIMAL,comment VARCHAR(23));
CREATE TABLE customer (custkey INT,name VARCHAR(25),address VARCHAR(40),nationkey INT,phone CHAR(15),acctbal DECIMAL,mktsegment   CHAR(10),comment      VARCHAR(117));
CREATE TABLE nation (nationkey    INT,name CHAR(25), regionkey    INT, comment      VARCHAR(152) );
CREATE TABLE partsupp (partkey      INT,suppkey      INT,availqty     INT,supplycost   DECIMAL,comment      VARCHAR(199));
CREATE TABLE region (regionkey    INT, name         CHAR(25), comment      VARCHAR(152) );

SELECT s.suppkey, s.name, s.address, s.phone, r1.total_revenue as total_revenue
FROM supplier s, 
     (SELECT l.suppkey AS supplier_no, 
             SUM(l.extendedprice * (1 - l.discount)) AS total_revenue
      FROM lineitem l
      WHERE l.shipdate >= DATE('1996-01-01')
        AND l.shipdate <  DATE('1996-04-01')
      GROUP BY l.suppkey) AS r1
WHERE 
    s.suppkey = r1.supplier_no;

SELECT l.shipmode
FROM   orders o, lineitem l
WHERE  o.orderkey = l.orderkey
  AND  l.shipmode IN ('MAIL', 'SHIP');

